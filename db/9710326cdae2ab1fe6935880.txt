<blockquote><h2>Chapter 12 - äº¤äº’å››å¤§ç»„ä»¶ä¹‹ï¼šæŒ‰é’®</h2>
<h3>ä¿®æ”¹ <code>events/interactionCreate.js</code></h3>
<p>å¯¹åº”çš„ commitï¼š
https://github.com/wtflmao/discord_bot_example/commit/eef8c0f3fb0ebed69c63eb776128acb28ceb8b3f
https://gitee.com/wtflmao/discord_bot_example/commit/eef8c0f3fb0ebed69c63eb776128acb28ceb8b3f</p>
<p>åœ¨æ–‡ä»¶çš„æœ€åé‚£å—å„¿é™„è¿‘ï¼Œæ‰¾åˆ°æœ€åä¸€ä¸ª elseï¼Œåœ¨è¿™ä¸ª else ä¸Šé¢æ’å…¥ä¸€ç§æ–°æƒ…å†µï¼Œç”¨äºæŒ‰é’®ï¼š</p>
<pre><code>else if (interaction.isButton()) {
	console.log("a button!");
}
</code></pre>
<h3>æ–°å»ºä¸€ä¸ªæ“ä½œè¡Œ ActionRow</h3>
<p>ä¸Šæ¥å…ˆå¯¼å…¥éœ€è¦çš„ <code>ActionRowBuilder</code>ï¼Œç”¨äºå»ºç«‹æ“ä½œè¡Œ ActionRowã€‚</p>
<p>é€šè¿‡ <code>new ActionRowBuilder()</code> æ–°å»ºã€‚</p>
<pre><code>const { ActionRowBuilder } = require('discord.js');

let row = new ActionRowBuilder()
    .addComponents(
        ... // æ­¤å¤„ç¡®å®šä½ éœ€è¦çš„ç»„ä»¶
    );
</code></pre>
<h3>æ–°å»ºæŒ‰é’® Button</h3>
<p>ä¸Šæ¥å…ˆå¯¼å…¥éœ€è¦çš„ <code>ActionRowBuilder</code> å’Œ <code>ButtonBuilder</code>ã€‚å‰è€…ç”¨äºå»ºç«‹æ“ä½œè¡Œï¼Œåè€…ç”¨äºå»ºç«‹ä¸€ä¸ªæŒ‰é’®ã€‚æŒ‰é’®éœ€è¦è¢«åŒ…å«åˆ°ä¸€è¡Œæ“ä½œè¡Œä¸Šå»ã€‚</p>
<p>é€šè¿‡ <code>new ButtonBuilder()</code> æ–°å»ºä¸€ä¸ªæŒ‰é’®ã€‚</p>
<pre><code>const { ActionRowBuilder, ButtonBuilder } = require('discord.js');

let row = new ActionRowBuilder()
    .addComponents(
        new ButtonBuilder()
	        // è®¾ç½®æŒ‰é’®è‡ªå®šä¹‰ ID
            .setCustomId('button1')

			// è®¾ç½®æŒ‰é’®æ ‡ç­¾ï¼Œå°±æ˜¯æŒ‰é’®ä¸Šçš„å­—
            .setLabel('Click me!')

			// è®¾ç½®æŒ‰é’®æ ·å¼ï¼Œå…·ä½“åœ¨ä¸‹ä¸€å°èŠ‚æœ‰è®²
            .setStyle(ButtonStyle.Primary)

			// è®¾ç½®æŒ‰é’®æ˜¯å¦è¢«ç¦ç”¨ï¼Œè¿™é‡Œçš„ false è¡¨ç¤ºæœªè¢«ç¦ç”¨
            .setDisabled(false)

			// è®¾ç½®ä¸€ä¸ª Emoji å‰ç¼€
            .setEmoji('ğŸ˜€'),
    );
</code></pre>
<p>è¿™ä¸ªæŒ‰é’®çš„æ ·å¼å¦‚å›¾ï¼š
<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119140537206-293552005.png" alt="image" /></p>
<h3>äº”ç§æŒ‰é’®çš„åŸºæœ¬æ ·å¼</h3>
<p>æŒ‰é’®ï¼ˆButtonï¼‰æ˜¯ç»„ä»¶ï¼ˆComponentï¼‰çš„ä¸€ç§ï¼Œé€šè¿‡ <code>components: []</code> æŒ‡å®šå“ªäº›æŒ‰é’®å°†å‘é€å‡ºå»ã€‚</p>
<p>ä¸€æ¡æ¶ˆæ¯é‡Œæœ€å¤šåŠ å…¥äº”ä¸ªæŒ‰é’®ã€‚å‡†ç¡®æ¥è¯´ï¼Œæ˜¯æœ€å¤šäº”ä¸ªç»„ä»¶ï¼ˆcomponentsï¼‰ï¼ŒæŒ‰é’®æ˜¯ç»„ä»¶çš„ä¸€ç§ã€‚</p>
<p>æŒ‰é’®æœ‰äº”ç§æ ·å¼ï¼šPrimaryã€Secondaryã€Successã€Danger å’Œ Linkï¼Œä¸‹é¢ç”¨ <code>commands/buttons/stylishButton.js</code> æ¥è¯´æ˜ï¼š</p>
<p>å¯¹åº”çš„ commitï¼š
https://github.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-81e417f8348606916071c665b42372b6e3a496eec5d6f934c129483d412b941b
https://gitee.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-81e417f8348606916071c665b42372b6e3a496eec5d6f934c129483d412b941b</p>
<pre><code>const { ActionRowBuilder, ButtonBuilder, ButtonStyle, SlashCommandBuilder } = require('discord.js');

module.exports = {
    data: new SlashCommandBuilder()
        .setName('stylishbutton')
        .setDescription('Replies with a button, but stylish!'),

    async execute(interaction) {

        let button1 = [], button1d = [];

        // // æ‰¹é‡ç”Ÿæˆäº†äº”ä¸ªæŒ‰é’®ï¼Œä¿å­˜åˆ°æ•°ç»„é‡Œï¼Œæ ¹æ®ä¸‹æ ‡æ¥ç¡®å®šæ¶ˆæ¯å†…å”¯ä¸€çš„ customId
        for (let i = 1; i &lt;= 5; i++) {
            button1.push(new ButtonBuilder()
                // åœ¨åŒä¸€æ¡å›å¤æ¶ˆæ¯ä¸­ï¼Œä½ éœ€è¦ç¡®ä¿æ‰€æœ‰ customId æ˜¯ä¸é‡å¤çš„ã€‚
                .setCustomId(`b1_${i}`)
                .setLabel(`Click me(${i})!`)
                .setStyle(ButtonStyle.Primary),);
        }

        // æ‰¹é‡ç”Ÿæˆäº†å››ä¸ªæŒ‰é’®ï¼Œä¿å­˜åˆ°æ•°ç»„é‡Œï¼Œæ ¹æ®ä¸‹æ ‡æ¥ç¡®å®šæ¶ˆæ¯å†…å”¯ä¸€çš„ customId
        for (let i = 1; i &lt;= 4; i++) {
            button1d.push(new ButtonBuilder()
                // åœ¨åŒä¸€æ¡å›å¤æ¶ˆæ¯ä¸­ï¼Œä½ éœ€è¦ç¡®ä¿æ‰€æœ‰ customId æ˜¯ä¸é‡å¤çš„ã€‚
                .setCustomId(`b1d_${i}`)
                .setLabel(`Click me(${i})!`)
                .setStyle(ButtonStyle.Primary)
                .setDisabled(true),);
        }

        // åœ¨ä¸€è¡Œé‡Œå¡äº†äº”ä¸ªæŒ‰é’®
        const rowPrimary = new ActionRowBuilder()
            .addComponents(button1);

        const rowSecondary = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId('b2')
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Secondary),
            );

        const rowSuccess = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId('b3')
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Success),
                new ButtonBuilder()
                    .setCustomId('b3d')
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Success)
                    .setDisabled(true),
            );

        const rowDanger = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    // åœ¨åŒä¸€æ¡å›å¤æ¶ˆæ¯ä¸­ï¼Œä½ éœ€è¦ç¡®ä¿æ‰€æœ‰ customId æ˜¯ä¸é‡å¤çš„ã€‚
                    // è¿™é‡Œæˆ‘ä»¬ç”¨æ¥éšæœºæ•°ç”Ÿæˆå‡½æ•°æ¥ç”Ÿæˆ IDï¼Œé™ä½ ID ç¢°æ’çš„æ¦‚ç‡ã€‚
                    .setCustomId(`b4_${Math.floor(Math.random() * 100000)}`)
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Danger),
            );

        const rowLink = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    // you can't .setCustomId() to a Link button
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Link)
                    .setURL("https://support.discord.com/hc/en-us"),
            );

        // åœ¨ä¸€è¡Œé‡Œå¡äº†å››ä¸ªæŒ‰é’®
        const rowPrimaryD = new ActionRowBuilder()
            .addComponents(button1d);

        const rowPrimary2D = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId(`owo`)
                    .setLabel("owo")
                    .setStyle(ButtonStyle.Primary)
                    .setDisabled(true),
            );

        const rowSecondaryD = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId('b2d')
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Secondary)
                    .setDisabled(true),
            );

        const rowDangerD = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId('b4d')
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Danger)
                    .setDisabled(true),
            );

        const rowLinkD = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    // ä½ ä¸èƒ½å¯¹ä¸€ä¸ªé“¾æ¥æŒ‰é’®è®¾ç½® customId å±æ€§
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Link)
                    .setURL("https://support.discord.com/hc/en-us")
                    .setDisabled(true),
            );

        // è¿™æ¡æ¶ˆæ¯é‡Œæˆ‘ä»¬æ’äº†ä¸‰è¡Œ ActionRow è¿›å»ã€‚
        await interaction.reply({ content: 'These are some Primary buttons:', components: [rowPrimary, rowPrimaryD, rowPrimary2D], ephemeral: false });

        // è¿™æ¡æ¶ˆæ¯é‡Œæˆ‘ä»¬æ’äº†ä¸¤è¡Œ ActionRow è¿›å»ã€‚
        await interaction.followUp({ content: 'These are two Secondary buttons. They are NOT on the same row:', components: [rowSecondary, rowSecondaryD], ephemeral: false });

        // è¿™æ¡æ¶ˆæ¯é‡Œæˆ‘ä»¬æ’äº†ä¸€è¡Œ ActionRow è¿›å»ã€‚
        await interaction.followUp({ content: 'These are two Success buttons. They are on the same row:', components: [rowSuccess], ephemeral: false });

        // è¿™æ¡æ¶ˆæ¯é‡Œæˆ‘ä»¬æ’äº†ä¸¤è¡Œ ActionRow è¿›å»ã€‚
        await interaction.followUp({ content: 'These are two Danger buttons. They are NOT on the same row:', components: [rowDanger, rowDangerD], ephemeral: false });

        // è¿™æ¡æ¶ˆæ¯é‡Œæˆ‘ä»¬æ’äº†ä¸¤è¡Œ ActionRow è¿›å»ã€‚
        await interaction.followUp({ content: 'These are two Link buttons. They are NOT on the same row:', components: [rowLink, rowLinkD], ephemeral: false });
    },
};
</code></pre>
<p>ä½¿ç”¨æŒ‰é’®æ ·å¼æ—¶ï¼Œè¦æ³¨æ„ç¬¬ä¸€è¡Œè¦å¯¼å…¥ ButtonStyleã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸€ä¸ªå›å¤æ¶ˆæ¯ï¼Œå…¶å®æœ‰ï¼ˆè‡³å°‘ï¼‰å››ä¸ªåŸŸï¼š<code>content</code>ã€<code>components</code> ã€ <code>embeds</code> å’Œ <code>ephemeral</code>ã€‚å…¶ä¸­ï¼Œ<code>content</code> æ˜¯å¿…é€‰çš„ï¼Œå…¶ä½™æ˜¯å¯é€‰çš„ã€‚å½“åªæœ‰ <code>content</code> æ—¶ï¼Œ"content" æ ‡ç­¾å¯ä»¥çœç•¥ï¼Œå¦‚ï¼š<code>await interaction.reply("1+1=2");</code>ã€‚</p>
<p>æ•ˆæœå›¾ï¼š
<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119143142765-1071464031.png" alt="image" /></p>
<p>åªæœ‰é“¾æ¥æŒ‰é’®å¯ä»¥æœ‰ä¸€ä¸ª urlã€‚é“¾æ¥æŒ‰é’®ä¸èƒ½æœ‰ customIdï¼Œå¹¶ä¸”åœ¨å•å‡»æ—¶ä¸å‘é€äº¤äº’äº‹ä»¶ã€‚</p>
<p>é€šè¿‡ <code>.setDisabled(true)</code> ä¸ºä¸€ä¸ªæŒ‰é’®è®¾ç½®ä¸å¯ç‚¹å‡»çš„å±æ€§ï¼Œè¿™æ ·ç”¨æˆ·å°±ä¸èƒ½ç‚¹å‡»è¿™ä¸ªæŒ‰é’®äº†ã€‚ä½†æ˜¯ä½ ä¸èƒ½å‘ä¸€ä¸ªå·²ç»å»ºæˆçš„ï¼ˆå³<code>new ActionRowBuilder()</code>è¿‡çš„ï¼‰æŒ‰é’®å˜é‡è®¾ç½®æ–°çš„å±æ€§ï¼Œä½ å¿…é¡»é‡æ–° new ä¸€ä¸ªæŒ‰é’®å‡ºæ¥ã€‚</p>
<h3>å¸¦æœ‰å‰ç¼€ Emoji çš„æŒ‰é’®</h3>
<p>ä¸‹é¢ç”¨ <code>commands/buttons/emojiButton.js</code> æ¥è¯´æ˜ï¼š</p>
<p>å¯¹åº”çš„ commitï¼š
https://github.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-b33acfdadb6c12912fe644066f8ef7e2852f86016539498309b0e2c08b3f5933
https://gitee.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-b33acfdadb6c12912fe644066f8ef7e2852f86016539498309b0e2c08b3f5933</p>
<pre><code>const { ActionRowBuilder, ButtonBuilder, ButtonStyle, SlashCommandBuilder } = require('discord.js');

module.exports = {
    data: new SlashCommandBuilder()
        .setName('emojibutton')
        .setDescription('Replies with a button, bu stylish!'),

    async execute(interaction) {

        const row = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId('b1')
                    .setLabel('Click me!')
                    .setStyle(ButtonStyle.Primary)
                    .setEmoji('ğŸ˜€'),
                new ButtonBuilder()
                    .setCustomId('b2')
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Secondary)
                    .setEmoji('ğŸ˜'),
                new ButtonBuilder()
                    .setCustomId('b3')
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Success)
                    .setEmoji('ğŸ¤£'),
                new ButtonBuilder()
                    .setCustomId(`b4`)
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Danger)
                    .setEmoji('ğŸ˜‡'),
                new ButtonBuilder()
                    // you cant .setCustomId() to a Link button
                    .setLabel("Click me!")
                    .setStyle(ButtonStyle.Link)
                    .setURL("https://support.discord.com/hc/en-us")
                    .setEmoji('ğŸ¤ª'),
            );

        // ä¸€æ¡æ¶ˆæ¯é‡Œæœ€å¤šäº”è¡Œ ActionRowï¼Œæ¯ä¸€è¡Œ ActionRow é‡Œæœ€å¤šæ’å…¥äº”ä¸ªåŒ…æ‹¬æŒ‰é’®åœ¨å†…çš„ç»„ä»¶
        await interaction.reply({ content: 'There are some buttons:', components: [row], ephemeral: false });},
};
</code></pre>
<p>æ•ˆæœå›¾ï¼š
<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119140812249-1843561049.png" alt="image" /></p>
<p>æ³¨æ„ï¼Œè¿™é‡Œ <code>.setEmoji()</code> åªèƒ½è®¾ç½®ä¸€ä¸ª emojiï¼Œä¸”åªä¼šå‡ºç°åœ¨æŒ‰é’® Label çš„å‰é¢ã€‚</p>
<p>è¿˜æœ‰ï¼Œä¸€æ¡æ¶ˆæ¯é‡Œæœ€å¤šäº”è¡Œ ActionRowï¼Œæ¯ä¸€è¡Œ ActionRow é‡Œæœ€å¤šæ’å…¥äº”ä¸ªæŒ‰é’®ï¼Œå‡†ç¡®æ¥è¯´ï¼Œæ˜¯æœ€å¤šäº”ä¸ªç»„ä»¶ï¼ˆcomponentsï¼‰ï¼ŒæŒ‰é’®æ˜¯ç»„ä»¶çš„ä¸€ç§ã€‚å¦‚éœ€äº”ä¸ªä»¥ä¸Šçš„æŒ‰é’®ï¼Œå¯ä»¥å°è¯•å›å¤å¤šæ¬¡ï¼Œæ¯”å¦‚ <code>.followUp()</code>ã€‚</p>
<h3>å¸¦æœ‰åµŒå¥—å…ƒç´ å’ŒæŒ‰é’®çš„å›å¤</h3>
<p>é€šè¿‡ <code>new EmbedBuilder()</code> æ–°å»ºä¸€ä¸ªåµŒå¥—å…ƒç´ ã€‚æ³¨æ„ç¬¬ä¸€è¡Œè¦å¯¼å…¥ EmbedBuilderã€‚</p>
<p>é€šè¿‡ <code>embeds: []</code> æŒ‡å®šå“ªäº›åµŒå¥—å…ƒç´ å°†å‘é€å‡ºå»ã€‚</p>
<p>åµŒå¥—å…ƒç´ ä¸æ˜¯æŒ‰é’®ä¸“å±ï¼ŒåµŒå¥—å…ƒç´ å…¶å®å’ŒæŒ‰é’®ç­‰ç»„ä»¶æ˜¯å¹³çº§çš„ã€‚</p>
<p>ä¸‹é¢çš„æºç æ³¨é‡Šæˆ‘ä¸ªäººè®¤ä¸ºè¯¥æœ‰çš„éƒ½æœ‰äº†ï¼Œæ¸…æ™°æ˜äº†ã€‚å°±ä¸å†åœ¨è¿™é‡Œè´¹ç¬”å¢¨å†å†™ä¸€éäº†ã€‚</p>
<p>ä¸‹é¢ç”¨ <code>commands/buttons/embeddedbutton.js</code> æ¥è¯´æ˜ï¼š</p>
<p>å¯¹åº”çš„ commitï¼š
https://github.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-f0a9d6890a4e8d5de14146749628d46fc9d5126a38f635f266993e4d35c4dcfa
https://gitee.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-f0a9d6890a4e8d5de14146749628d46fc9d5126a38f635f266993e4d35c4dcfa</p>
<pre><code>const { ActionRowBuilder, ButtonBuilder, ButtonStyle, EmbedBuilder, SlashCommandBuilder } = require('discord.js');

let updatedBtnMsg = new Map();

module.exports = {
    data: new SlashCommandBuilder()
        .setName('embeddedbutton')
        .setDescription('Replies with a button, but embedded!'),

    async execute(interaction) {
        updatedBtnMsg.set("0", false);

        const row = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    // éšæœºåŒ– Id ä»¥æ±‚å¥½è¿
                    .setCustomId(`b3_${Math.floor(Math.random() * 100000)}`)
                    .setLabel("Got it! Dismiss.")
                    .setStyle(ButtonStyle.Success),
            );

        const rowD = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId(`b3d`)
                    .setLabel("Got it! Dismiss.")
                    .setStyle(ButtonStyle.Success)
                    .setDisabled(true),
            );

        const hc = new EmbedBuilder()
            .setColor(0x0099FF)
            .setTitle("&gt;&gt;&gt;Discord Help Center&lt;&lt;&lt;")
            .setURL('https://support.discord.com/hc/en-us')
            .setDescription("Need help? We've got your back.");

        await interaction.reply({ content: 'R U seeking for assistance using Discord?', components: [row], embeds: [hc], ephemeral: true });

        const filter = i =&gt; {
            // è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº†ä¸‹é¢ä¼šå°†çš„â€œæ”¶é›†å™¨â€ï¼Œå‡†ç¡®æ¥è¯´æ˜¯â€œåŸºæœ¬æ¶ˆæ¯ç»„ä»¶æ”¶é›†å™¨â€
            // filter æ˜¯æ”¶é›†å™¨ collector çš„ä¸€ä¸ªè¿‡æ»¤å™¨ã€‚
            // å¦‚æœè¯¥æ¶ˆæ¯æ—©å·²è¢«å…¶ä»–æ”¶é›†å™¨å®ä¾‹æ”¶é›†èµ°äº†ï¼Œé‚£å°±è¿”å› falseï¼Œè¡¨ç¤ºæœ¬æ”¶é›†å™¨æ‹’ç»æ”¶é›†è¯¥æ¶ˆæ¯ã€‚è¿™åœ¨å¹¶å‘åœºæ™¯ä¸‹å¾ˆå¥½ç”¨ã€‚
            if (updatedBtnMsg.has(i.message.id)) {
                return false;
            } else { // è¿è¡Œåˆ°è¿™æ¡ else åˆ†æ”¯ï¼Œæ„å‘³ç€è¯¥æ¶ˆæ¯æœªè¢«æ›¾æ”¶é›†è¿‡ã€‚
                if (i.customId.startsWith('b3')) {
                    // æˆ‘ä»¬ä¸éœ€è¦éªŒè¯æŒ‰é’®æ¶ˆæ¯çš„å‘èµ·è€…å’ŒæŒ‰æŒ‰é’®çš„äººæ˜¯å¦æ˜¯åŒä¸€ä¸ªäººï¼Œ
	                // å› ä¸ºè¿™ä¿©äººè‚¯å®šæ˜¯åŒä¸€ä¸ªäººï¼Œå› ä¸ºæŒ‰é’®æ¶ˆæ¯å·²è¢«è®¾ç½®ä¸º ephemeralï¼Œ
	                // ç”šè‡³ä¸ä¼šæœ‰å¤–äººèƒ½çœ‹åˆ°è¿™æ¡æ¶ˆæ¯ï¼Œæ›´åˆ«è¯´æŒ‰è¿™ä¸ªæŒ‰é’®äº†
                    updatedBtnMsg.set(i.message.id, true);
                    return true;
                } else {
                    // è¿™æ¡åˆ†æ”¯æ„å‘³ç€ä¸æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ i.customId.startsWith('b3') === true
                    // å³æŒ‰ä¸‹çš„æŒ‰é’®çš„ Id ä¸æ˜¯ b3 æ‰“å¤´çš„ã€‚æˆ‘ä»¬ä¸è¦ã€‚
                    return false;
                }
            }
        };

        const collector = interaction.channel.createMessageComponentCollector({
            filter,
            max: 1, // æˆ‘ä»¬åªæƒ³è®©æ”¶é›†å™¨æ”¶é›†ä¸€ä¸ªæ»¡è¶³ filter æ¡ä»¶çš„ Interaction
		            // å¦‚æœä½ æƒ³åªé’ˆå¯¹ç‰¹å®šç»„ä»¶ç±»å‹è¿›è¡Œæ”¶é›†çš„è¯ï¼Œä½¿ç”¨ componentType æ ‡ç­¾
		            // å¦‚æœä½ æƒ³è®¾ç½®æ”¶é›†çš„æœ€å¤§ç»„ä»¶æ•°ï¼Œä½¿ç”¨ maxComponents
		            // æœ€å¤§äº¤äº’ç”¨æˆ·æ•°ï¼Œä½¿ç”¨ maxUsers
            time: 20 * 1000, // 20.000 secsï¼Œä»¥æ¯«ç§’ä¸ºå•ä½è¿è¡Œæ”¶é›†å™¨å¤šé•¿æ—¶é—´ï¼Œä¸è®¾ç½®åˆ™ä¸€ç›´æ”¶é›†
						    // å¦‚æœè¦è®¾ç½®ä¸æ´»åŠ¨ååœæ­¢æ”¶é›†å™¨å¤šé•¿æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ï¼Œä½¿ç”¨ idle
        });

        collector.on('collect', async i =&gt; {
            // æ˜ç¡®åœ°ä»¤ component æ•°ç»„ä¸ºç©ºæ•°ç»„ï¼Œå¯ä»¥åœ¨ .update() æ—¶åˆ é™¤è¯¥æ¶ˆæ¯çš„ä»»ä½•ç»„ä»¶ã€‚
            // æ˜ç¡®åœ°ä»¤ embeds æ•°ç»„ä¸ºç©ºæ•°ç»„ï¼Œå¯ä»¥åœ¨ .update() æ—¶åˆ é™¤è¯¥æ¶ˆæ¯çš„ä»»ä½•åµŒå¥—å…ƒç´ ã€‚
            await i.update({ content: `Nice.`, components: [rowD], embeds: []});
        });

        collector.on('end', collected =&gt; {
            console.log(`Collected ${collected.size} items`);

            // ä¸ºäº†ç¡®ä¿æ•°ç»„ä¸‹æ ‡è®¿é—®[0]ä¸è¶Šç•Œï¼Œæˆ‘ä»¬è¿™é‡Œè¦æ±‚æ•°ç»„ä¸ä¸ºç©º
            if (collected.size &gt; 0) {
                console.log((Array.from(collected.values()))[0].customId);
            }
        });

    },
};
</code></pre>
<p>æ•ˆæœå›¾ï¼š
<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119141119800-67771465.png" alt="image" />
æŒ‰ä¸‹æŒ‰é’®åï¼š
<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119141123741-159560186.png" alt="image" /></p>
<h3>å…¶ä»–å¯¹æŒ‰é’®çš„æ“ä½œ</h3>
<ul>
<li><code>reply()</code></li>
<li><code>editReply()</code></li>
<li><code>deferReply()</code></li>
<li><code>fetchReply()</code></li>
<li><code>deleteReply()</code></li>
<li><code>followUp()</code></li>
</ul>
<p>æˆ‘ä»¬è¿™é‡Œå±•ç¤ºä¸€ä¸‹ <code>deferReply()</code> å’Œ <code>deleteReply()</code>ã€‚</p>
<p>ä¸‹é¢çš„æºç æ³¨é‡Šæˆ‘ä¸ªäººè®¤ä¸ºè¯¥æœ‰çš„éƒ½æœ‰äº†ï¼Œæ¸…æ™°æ˜äº†ã€‚å°±ä¸å†åœ¨è¿™é‡Œè´¹ç¬”å¢¨å†å†™ä¸€éäº†ã€‚</p>
<p>ä¸‹é¢ç”¨ <code>commands/buttons/deferAndDelete.js</code> æ¥è¯´æ˜ï¼š</p>
<p>å¯¹åº”çš„ commitï¼š
https://github.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-16f8992fc6c047410730afb876fa5a8a9c8ed7b312c9f991f52bdb9ca8f85b8f
https://gitee.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-16f8992fc6c047410730afb876fa5a8a9c8ed7b312c9f991f52bdb9ca8f85b8f</p>
<pre><code>const { ActionRowBuilder, ButtonBuilder, ButtonStyle, SlashCommandBuilder } = require('discord.js');
const wait = require('node:timers/promises').setTimeout;

let updatedBtnMsg = new Map();

module.exports = {
    data: new SlashCommandBuilder()
        .setName('ddbutton')
        .setDescription('Replies with a button, but deferred, also self-delete!'),

    async execute(interaction) {
        updatedBtnMsg.set("0", false);

        const row = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    // Randomize the button's customId for good luck, like "b1_90372" or "b1_1827".
                    .setCustomId(`b1_${Math.floor(Math.random() * 100000)}`)
                    .setLabel("Update weather data")
                    .setStyle(ButtonStyle.Primary),
            );

        await interaction.reply({ content: 'This is a button:', components: [row], embeds: [], ephemeral: false });

        const filter = i =&gt; {
            // If the target message has been collected and edited by the other collector instance,
            // then return false, telling the current collector that "do not collect this msg, or else, DIE!!", LOL.
            if (updatedBtnMsg.has(i.message.id)) {
                return false;
            } else {
                // Here, this msg hasn't been collected yet.
                if (i.customId.startsWith('b1') &amp;&amp; (i.user.id === interaction.user.id)) {
                    // Here, it fulfills our requirements: a.is a DANGEROUS button(customId starts with "b4_"), and b. the "button msg"'s author is the person that presses the button
                    // Put this &lt;i.message.id, true&gt; record into the Map, so that we can no longer collect it
                    // (like when many active collectors all see the same button interaction fulfills its requirements, then they all wanna edit the same msg, but to only find the interaction has already been acknowledged and the bot be halted.)
                    updatedBtnMsg.set(i.message.id, true);
                } else {
                    // Here, it doesn't meet all the requirements we need, so do not collect it.
                    return false;
                }
            }
            updatedBtnMsg.delete(i.message.id);
            return true;
        };

        const collector = interaction.channel.createMessageComponentCollector({
            filter,
            time: 18000, // 18 secs
        });

        collector.on('collect', async i =&gt; {
            // use .deferUpdate() to simulate an API response process from a weather channel.
            await i.deferUpdate();
            await i.editReply({ content: `Updating...`, components:[] });
            await wait(3350); //wait 3.350 secs
            await i.editReply({ content: `Las Vegas, NV\nAs of ${Math.floor(Math.random() * 11) + 1}:${Math.floor(Math.random() * 59)} am PST\n44Â°F\nFair\nDay ${Math.floor(Math.random() * 10) + 66}Â°F â€¢ Night ${39 - Math.floor(Math.random() * 10)}Â°F`, embeds: [], components: [row] });
        });

        collector.on('end', collected =&gt; {
            console.log(`Collected ${collected.size} items`);

            // To make sure there's at least one item in the array,
            // to prevent accessing the first element of an empty array, which leads to out-of-bounds memory access
            if (collected.size &gt; 0) {
                // To delete the whole reply, do .deleteReply() for the last collected item, not all the items.
                (Array.from(collected.values()))[collected.size - 1].deleteReply();
                console.log((Array.from(collected.values()))[0].customId);
            }
        });

    },
};
</code></pre>
<p>æ•ˆæœå›¾ï¼š
åˆšå‘å‡ºæ–œæ å‘½ä»¤äº¤äº’åï¼š<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119141436425-1654461385.png" alt="image" />
ç‚¹å‡» Update weather button åï¼š
<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119141504850-2016161105.png" alt="image" />
ç»“æœï¼š<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119141525899-129872057.png" alt="image" /></p>
<h3>æ¶ˆæ¯ç»„ä»¶æ”¶é›†å™¨ï¼šå¤„ç†æŒ‰é’®è¢«æŒ‰ä¸‹åçš„äº¤äº’æ“ä½œ</h3>
<p>æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ª Discord.js ä¸ºæˆ‘ä»¬æä¾›çš„ä¸€ç§â€œæ”¶é›†å™¨â€ï¼ˆCollectorï¼‰æ¥ç›‘å¬ä¸€ç§äº¤äº’ï¼šæŒ‰é’®è¢«æŒ‰ä¸‹è¿™ç§äº¤äº’ã€‚</p>
<p>å…¶å®æ¶ˆæ¯ç»„ä»¶æ”¶é›†å™¨å¯ä»¥æ”¶é›†ä»»ä½•æ¶ˆæ¯ç»„ä»¶ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬åªåœ¨ä¹æŒ‰é’®çš„äº¤äº’ã€‚</p>
<p>æ¶ˆæ¯ç»„ä»¶æ”¶é›†å™¨ï¼Œè¿™ç§æ”¶é›†å™¨æœ‰ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯ Discord æœŸæœ›ä½ çš„æœºå™¨äººåœ¨ 3 ç§’å†…å¯¹æ‰€æœ‰äº¤äº’åšå‡ºå“åº”ï¼Œå³ä½¿æ˜¯æ‚¨ä¸æƒ³æ”¶é›†çš„äº¤äº’ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œå®è·µä¸­çš„è®¸å¤šæƒ…å†µä¸‹ï¼Œåœ¨ filter ä¸­ä¸Šæ¥å°±æ¥ä¸ª <code>.deferUpdate()</code>ï¼Œç”šè‡³æ”¾å¼ƒä½¿ç”¨ filterï¼Œç›´æ¥è®© collector æ¥è€…ä¸æ‹’ï¼Œä¸Šæ¥åŒæ ·å…ˆ <code>.deferUpdate()</code>ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œæ²¡æœ‰è¿™ä¹ˆåšã€‚</p>
<p>ä¸‹é¢çš„æºç æ³¨é‡Šæˆ‘ä¸ªäººè®¤ä¸ºè¯¥æœ‰çš„éƒ½æœ‰äº†ï¼Œæ¸…æ™°æ˜äº†ã€‚å°±ä¸å†åœ¨è¿™é‡Œè´¹ç¬”å¢¨å†å†™ä¸€éäº†ã€‚</p>
<p>ä¸‹é¢ç”¨ <code>commands/buttons/deferAndDelete.js</code> æ¥è¯´æ˜ï¼š</p>
<p>å¯¹åº”çš„ commitï¼š
https://github.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-da8b6abce1aa8943cff70045dec60a8d70461e8f6cb0e5c9327e5235f5ead4c5
https://gitee.com/wtflmao/discord_bot_example/commit/21c5f65d81cedbce987a59dfe4c9db4251817d41#diff-da8b6abce1aa8943cff70045dec60a8d70461e8f6cb0e5c9327e5235f5ead4c5</p>
<pre><code>const { ActionRowBuilder, ButtonBuilder, ButtonStyle, EmbedBuilder, SlashCommandBuilder } = require('discord.js');
const wait = require('node:timers/promises').setTimeout;

let updatedBtnMsg = new Map();

module.exports = {
	data: new SlashCommandBuilder()
       .setName('button')
       .setDescription('Replies with a button!'),

	async execute(interaction) {
		updatedBtnMsg.set("0", false);

		const rowDanger = new ActionRowBuilder()
			.addComponents(
				new ButtonBuilder()
					// Randomize the button's customId for good luck, like "b4_90372" or "b4_1827".
					.setCustomId(`b4_${Math.floor(Math.random() * 100000)}`)
					.setLabel("Click me!")
					.setStyle(ButtonStyle.Danger),
			);

		const rowDangerD = new ActionRowBuilder()
			.addComponents(
				new ButtonBuilder()
					// Because the button is disabled, no one can actually click that.
					// So there's no avail to randomize its customId.
					.setCustomId('b4d')
					.setLabel("YOU CLICKED ME!")
					.setStyle(ButtonStyle.Danger)
					.setDisabled(true),
			);

		const rowSecD = new ActionRowBuilder()
			.addComponents(
				new ButtonBuilder()
					// Because the button is disabled, no one can actually click that.
					// So there's no avail to randomize its customId.
					.setCustomId('b2d')
					.setLabel("It's fine.")
					.setStyle(ButtonStyle.Secondary)
					.setDisabled(true),
			);

		const embed = new EmbedBuilder()
			.setColor(0x0099FF)
			.setTitle("hhzm's blog")
			.setURL('https://www.cnblogs.com/hhzm/')
			.setDescription("hhzm's cnblog site");

		await interaction.reply({ content: 'This is a Danger button:', components: [rowDanger], embeds: [embed], ephemeral: false });

		const filter = i =&gt; {
			// If the target message has been collected and edited by the other collector instance,
			// then return false, telling the current collector that "do not collect this msg, or else, DIE!!", LOL.
			if (updatedBtnMsg.has(i.message.id)) {
				return false;
			} else {
				// Here, this msg hasn't been collected yet.
				if (i.customId.startsWith('b4') &amp;&amp; (i.user.id === interaction.user.id)) {
					// Here, it fulfills our requirements: a.is a DANGEROUS button(customId starts with "b4_"), and b. the "button msg"'s author is the person that presses the button
					// Put this &lt;i.message.id, true&gt; record into the Map, so that we can no longer collect it
					// (like when many active collectors all see the same button interaction fulfills its requirements, then they all wanna edit the same msg, but to only find the interaction has already been acknowledged and the bot be halted.)
					updatedBtnMsg.set(i.message.id, true);
					return true;
				} else {
					// Here, it doesn't meet all the requirements we need, so do not collect it.
					return false;
				}
			}
		};

		// here we used interaction.channel.createMessageComponentCollector()
		// rather than message.createMessageComponentCollector()
		// to show you guys how a collector that focuses on channel works.
		const collector = interaction.channel.createMessageComponentCollector({
			filter,
			max: 1, // We only want this collector instance collects 1 eligible message component
			time: 15 * 1000, // 15.000 secs
		});

		collector.on('collect', async i =&gt; {
			await i.update({ content: `A DANGEROUS button was clicked! ${i.customId}`, embeds: [], components: [rowDangerD] });
			await wait(6969);

			// use .editReply() rather than another .update() here
			// Passing an empty array to the components option will remove any buttons after one has been clicked.
			// Passing an empty array to the embeds option will remove any embeds after one has been clicked.
			await i.editReply({ content: `Danger mitigated.`, components: [rowSecD], embeds: [] });
		});

		collector.on('end', collected =&gt; {
			console.log(`Collected ${collected.size} items`);

			// To make sure there's at least one item in the array,
			// to prevent accessing the first element of an empty array, which leads to out-of-bounds memory access
			if (collected.size &gt; 0) {
				console.log((Array.from(collected.values()))[0].customId);
			}
		});

	},
};
</code></pre>
<p>æ•ˆæœå›¾ï¼š
<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119141809776-952418961.png" alt="image" />
ç„¶å
<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119144938255-2082627602.png" alt="image" />
ç„¶å
<img src="https://img2022.cnblogs.com/blog/2455224/202211/2455224-20221119141819927-1945822726.png" alt="image" /></p>
<p>éœ€è¦æ³¨æ˜çš„æ˜¯ï¼Œæˆ‘ä»¬è¿™é‡Œçš„æ”¶é›†å™¨â€œç›‘å¬â€çš„æ˜¯é¢‘é“ï¼ˆChannelï¼‰é‡Œçš„ç»„ä»¶äº‹ä»¶ã€‚æ¶ˆæ¯ç»„ä»¶æ”¶é›†å™¨è¿˜æœ‰å¦ä¸€ç§ç›‘å¬å¯¹è±¡ï¼šæ¶ˆæ¯ï¼ˆMessageï¼‰ã€‚</p>
<p>ç›‘å¬æŸä¸ª Channelï¼š</p>
<pre><code>const collector = interaction.channel.createMessageComponentCollector();
</code></pre>
<p>æ­¤æ—¶ï¼Œåªè¦æ”¶é›†å™¨ä»åœ¨å·¥ä½œï¼Œåˆ™è¯¥æ”¶é›†å™¨çš„ç›®æ ‡é¢‘é“é‡Œçš„æ‰€æœ‰ MessageComponent äº‹ä»¶éƒ½å¯ä»¥æˆä¸ºæ”¶é›†å™¨çš„æ”¶é›†å¯¹è±¡ã€‚æ¯”å¦‚æœ¬ä¾‹ä¸­ï¼Œå“ªæ€•ä¹‹å‰æœºå™¨äººå·²é‡å¯è¿‡å¥½å‡ æ¬¡äº†ï¼Œåªè¦æœ‰äººæ‰§è¡Œäº†æ–œæ å‘½ä»¤ /buttonï¼Œé‚£ä¹ˆå“ªæ€•æ˜¯ï¼ˆåœ¨è¿™ä¸ªé¢‘é“é‡Œï¼‰ä¸Šä¸ªæœˆçš„æŒ‰é’®ï¼Œåªè¦æ»¡è¶³äº† filter çš„æ¡ä»¶ï¼Œä¹Ÿèƒ½å¤Ÿè¢«æ”¶é›†å™¨æ”¶é›†åˆ°ï¼Œè¿›è€Œå¹²è¯¥å¹²çš„äº‹ã€‚</p>
<p>ç›‘å¬æŸä¸ª Messageï¼š</p>
<pre><code>message = await interaction.fetchReply();
const collector = message.createMessageComponentCollector();
</code></pre>
<p>æ­¤æ—¶ï¼Œåªè¦ç›‘å¬æŸæ¡ç‰¹å®šæ¶ˆæ¯çš„æ”¶é›†å™¨åœæ­¢äº†å·¥ä½œï¼Œé‚£ä¹ˆåœ¨æœ¬ä¾‹ä¸­ï¼Œæ²¡æœ‰å…¶ä»–çš„æ”¶é›†å™¨å¯ä»¥åœ¨æ”¶é›†åˆ°è¯¥æŒ‰é’®çš„ç»„ä»¶äº‹ä»¶äº†ï¼Œå“ªæ€•æ»¡è¶³ filter çš„æ¡ä»¶äº†ä¹Ÿä¸è¡Œã€‚æœ¬ä¾‹ä½¿ç”¨çš„æ˜¯å¯¹è±¡æ˜¯é¢‘é“çš„æ”¶é›†å™¨ã€‚</p>
<p>ä½ å¯ä»¥è‡ªç”±é€‰æ‹©æ˜¯ä½¿ç”¨å¯¹è±¡æ˜¯é¢‘é“çš„æ¶ˆæ¯ç»„ä»¶æ”¶é›†å™¨ï¼Œè¿˜æ˜¯ä½¿ç”¨å¯¹è±¡æ˜¯æ¶ˆæ¯çš„æ¶ˆæ¯ç»„ä»¶æ”¶é›†å™¨ï¼Œæ¥ç®€åŒ–ä½ çš„ä»»åŠ¡ã€‚</p></blockquote>